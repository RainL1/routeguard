/** @page testing_blue_team Методика тестирования и Blue Team-проверка

@section testing_goal Цель проверки

Подтвердить, что RouteGuard:
- обнаруживает признаки TunnelVision-подобного обхода VPN;
- предотвращает утечку трафика вне VPN в режиме `protect`;
- корректно очищает `nftables`-правила при остановке.

@section testing_scenarios Сценарии

@subsection testing_s1 S1: Проверка применения правил
1. Запустить `protect`.
2. Выполнить `sudo nft list table inet routeguard`.
3. Убедиться в наличии правил `accept` для VPN-интерфейса и `drop` для трафика вне VPN.

@subsection testing_s2 S2: Проверка kill-switch
1. Поднять WireGuard и запустить RouteGuard в `protect`.
2. Убедиться, что интернет работает.
3. Отключить VPN (`wg-quick down <iface>`).
4. Проверить, что исходящие соединения не проходят (утечка предотвращена).

@subsection testing_s3 S3: Симуляция TunnelVision-подобной атаки
1. Добавить split-default маршруты через обычный интерфейс:
   - `0.0.0.0/1`
   - `128.0.0.0/1`
2. Убедиться, что RouteGuard фиксирует их как подозрительные.
3. Проверить, что при `protect` трафик вне VPN блокируется `nftables`.

@section testing_acceptance Критерии приемки

Система считается работоспособной, если:
- конфигурация WireGuard корректно парсится автоматически;
- правила `nftables` создаются и удаляются без ошибок;
- в `monitor` происходит детектирование подозрительных маршрутов;
- в `protect` отсутствует утечка трафика вне VPN;
- GUI и CLI обеспечивают одинаковую защитную логику.

*/
